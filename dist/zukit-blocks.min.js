(function () {
  'use strict';

  function _defineProperty(obj, key, value) {
    if (key in obj) {
      Object.defineProperty(obj, key, {
        value: value,
        enumerable: true,
        configurable: true,
        writable: true
      });
    } else {
      obj[key] = value;
    }

    return obj;
  }

  function _extends() {
    _extends = Object.assign || function (target) {
      for (var i = 1; i < arguments.length; i++) {
        var source = arguments[i];

        for (var key in source) {
          if (Object.prototype.hasOwnProperty.call(source, key)) {
            target[key] = source[key];
          }
        }
      }

      return target;
    };

    return _extends.apply(this, arguments);
  }

  function ownKeys(object, enumerableOnly) {
    var keys = Object.keys(object);

    if (Object.getOwnPropertySymbols) {
      var symbols = Object.getOwnPropertySymbols(object);
      if (enumerableOnly) symbols = symbols.filter(function (sym) {
        return Object.getOwnPropertyDescriptor(object, sym).enumerable;
      });
      keys.push.apply(keys, symbols);
    }

    return keys;
  }

  function _objectSpread2(target) {
    for (var i = 1; i < arguments.length; i++) {
      var source = arguments[i] != null ? arguments[i] : {};

      if (i % 2) {
        ownKeys(Object(source), true).forEach(function (key) {
          _defineProperty(target, key, source[key]);
        });
      } else if (Object.getOwnPropertyDescriptors) {
        Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));
      } else {
        ownKeys(Object(source)).forEach(function (key) {
          Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));
        });
      }
    }

    return target;
  }

  function _objectWithoutPropertiesLoose(source, excluded) {
    if (source == null) return {};
    var target = {};
    var sourceKeys = Object.keys(source);
    var key, i;

    for (i = 0; i < sourceKeys.length; i++) {
      key = sourceKeys[i];
      if (excluded.indexOf(key) >= 0) continue;
      target[key] = source[key];
    }

    return target;
  }

  function _objectWithoutProperties(source, excluded) {
    if (source == null) return {};

    var target = _objectWithoutPropertiesLoose(source, excluded);

    var key, i;

    if (Object.getOwnPropertySymbols) {
      var sourceSymbolKeys = Object.getOwnPropertySymbols(source);

      for (i = 0; i < sourceSymbolKeys.length; i++) {
        key = sourceSymbolKeys[i];
        if (excluded.indexOf(key) >= 0) continue;
        if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;
        target[key] = source[key];
      }
    }

    return target;
  }

  function _slicedToArray(arr, i) {
    return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest();
  }

  function _toConsumableArray(arr) {
    return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread();
  }

  function _arrayWithoutHoles(arr) {
    if (Array.isArray(arr)) return _arrayLikeToArray(arr);
  }

  function _arrayWithHoles(arr) {
    if (Array.isArray(arr)) return arr;
  }

  function _iterableToArray(iter) {
    if (typeof Symbol !== "undefined" && Symbol.iterator in Object(iter)) return Array.from(iter);
  }

  function _iterableToArrayLimit(arr, i) {
    if (typeof Symbol === "undefined" || !(Symbol.iterator in Object(arr))) return;
    var _arr = [];
    var _n = true;
    var _d = false;
    var _e = undefined;

    try {
      for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {
        _arr.push(_s.value);

        if (i && _arr.length === i) break;
      }
    } catch (err) {
      _d = true;
      _e = err;
    } finally {
      try {
        if (!_n && _i["return"] != null) _i["return"]();
      } finally {
        if (_d) throw _e;
      }
    }

    return _arr;
  }

  function _unsupportedIterableToArray(o, minLen) {
    if (!o) return;
    if (typeof o === "string") return _arrayLikeToArray(o, minLen);
    var n = Object.prototype.toString.call(o).slice(8, -1);
    if (n === "Object" && o.constructor) n = o.constructor.name;
    if (n === "Map" || n === "Set") return Array.from(o);
    if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);
  }

  function _arrayLikeToArray(arr, len) {
    if (len == null || len > arr.length) len = arr.length;

    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];

    return arr2;
  }

  function _nonIterableSpread() {
    throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");
  }

  function _nonIterableRest() {
    throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");
  }

  function createCommonjsModule(fn, basedir, module) {
  	return module = {
  		path: basedir,
  		exports: {},
  		require: function (path, base) {
  			return commonjsRequire(path, (base === undefined || base === null) ? module.path : base);
  		}
  	}, fn(module, module.exports), module.exports;
  }

  function commonjsRequire () {
  	throw new Error('Dynamic requires are not currently supported by @rollup/plugin-commonjs');
  }

  var classnames = createCommonjsModule(function (module) {
  /*!
    Copyright (c) 2017 Jed Watson.
    Licensed under the MIT License (MIT), see
    http://jedwatson.github.io/classnames
  */
  /* global define */

  (function () {

  	var hasOwn = {}.hasOwnProperty;

  	function classNames () {
  		var classes = [];

  		for (var i = 0; i < arguments.length; i++) {
  			var arg = arguments[i];
  			if (!arg) continue;

  			var argType = typeof arg;

  			if (argType === 'string' || argType === 'number') {
  				classes.push(arg);
  			} else if (Array.isArray(arg) && arg.length) {
  				var inner = classNames.apply(null, arg);
  				if (inner) {
  					classes.push(inner);
  				}
  			} else if (argType === 'object') {
  				for (var key in arg) {
  					if (hasOwn.call(arg, key) && arg[key]) {
  						classes.push(key);
  					}
  				}
  			}
  		}

  		return classes.join(' ');
  	}

  	if ( module.exports) {
  		classNames.default = classNames;
  		module.exports = classNames;
  	} else {
  		window.classNames = classNames;
  	}
  }());
  });

  var _ = lodash;
  var __ = wp.i18n.__;
  var _wp$components = wp.components,
      Path = _wp$components.Path,
      G = _wp$components.G,
      SVG = _wp$components.SVG;
  var _wp$blocks = wp.blocks,
      getCategories = _wp$blocks.getCategories,
      setCategories = _wp$blocks.setCategories,
      registerBlockCollection = _wp$blocks.registerBlockCollection; // Gets JSON data from PHP

  function externalData(key) {
    var defaultValues = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;

    var _ref = window[key] || {},
        _ref$data = _ref.data,
        data = _ref$data === void 0 ? {} : _ref$data;

    return _.isEmpty(defaultValues) ? data : _.defaults(data, defaultValues);
  } // Just a more familiar name

  var mergeClasses = classnames; // Checks if value can be converted to Number

  function isNum(n) {
    return !_.isNaN(parseFloat(n)) && isFinite(n);
  } // convert argument to Boolean value
  // works for true, false, 0, 1, "true", "false", "TRUE", "FALSE", "0", "1", undefined

  function toBool(val) {
    var stringOrNull = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;
    var num;
    var value = val != null && (!_.isNaN(num = +val) ? !!num : !!String(val).toLowerCase().replace(!!0, ''));
    return stringOrNull ? value ? String(value) : null : value;
  }
  function toRange(num, min, max) {
    var useMinOnErr = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : true;
    var value = _.isNaN(+num) ? useMinOnErr ? min : max : num;
    return _.clamp(_.round(value), min, max);
  } // Create key for react components from 'value' or other params

  function getKey(value, more) {
    var source = _.isString(value) || isNum(value) ? String(value) : String(more);
    var hash = 0,
        i;

    for (i = 0; i < source.length; i++) {
      hash = (hash << 5) - hash + source.charCodeAt(i);
      hash |= 0; // Convert to 32bit integer
    }

    return String(hash);
  }
  // Ensures the ids array contains numbers

  function getIds(items) {
    var asString = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;
    // always ensure the ids array contains numbers.
    // And remove all elements with "empty" value (undefined, null)
    if (!items || items.length === 0) return asString ? '' : [];

    var ids = _.compact(_.map(items, function (value) {
      return value && value.id && parseInt(value.id, 10);
    }));

    return asString ? _.join(ids, ',') : ids;
  }
  function checkDependency(item, options) {
    var isAction = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;
    var depends = isAction ? item : _.get(item, 'depends');
    if (_.isNil(depends)) return true;
    if (depends === false) return false;

    var value = options[_.trimStart(depends, '!')];

    return _.startsWith(depends, '!') ? !value : value;
  } // Convert object to JSON

  function toJSON(obj) {
    if (obj) {
      try {
        obj = JSON.stringify(obj);
      } catch (err) {
        obj = '{}';
      }
    }

    return obj || '{}';
  } // Add error value (if present) to the message, converting any object to a string

  function messageWithError(message) {
    var value = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;
    if (_.isNil(value)) return message;
    value = _.isArray(value) || _.isPlainObject(value) ? toJSON(value) : String(value);
    value = value.replace(/([{|}])/g, ' $1 ').replace(/,\s*/g, ',  ').replace(/"([^"]+)":/g, '<b>$1</b>: ');
    return message.replace(/[:|.]\s*$/g, '') + ": <span class=\"zukit-data\">".concat(value, "</span>");
  } // Returns SVG with a reference to an already loaded SVG set

  function svgRef(id) {
    var icon = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;
    var moreClasses = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : '';
    var iconsSize = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 24;
    var size = iconsSize; // change viewBox values according to Icons Set

    return /*#__PURE__*/React.createElement("svg", {
      className: classnames('zu-svg', {
        icon: icon
      }, "icon-".concat(id), moreClasses),
      role: "img",
      "aria-labelledby": "title",
      viewBox: "0 0 ".concat(size, " ").concat(size),
      preserveAspectRatio: "xMidYMin slice"
    }, /*#__PURE__*/React.createElement("use", {
      xlinkHref: "#".concat(id)
    }));
  }
  function hexToRGB(hex) {
    var asObject = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;
    var result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
    var rgb = result ? {
      r: parseInt(result[1], 16),
      g: parseInt(result[2], 16),
      b: parseInt(result[3], 16)
    } : null;
    return rgb ? asObject ? rgb : "rgb(".concat(rgb.r, ",").concat(rgb.g, ",").concat(rgb.b, ")") : null;
  }
  function hexToRGBA(hex, alpha) {
    var asObject = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;
    var rgb = hexToRGB(hex, true);
    if (rgb === null) return null;

    var rgba = _.set(_objectSpread2({}, rgb), 'a', alpha);

    return asObject ? rgba : "rgba(".concat(rgba.r, ",").concat(rgba.g, ",").concat(rgba.b, ",").concat(rgba.a, ")");
  } // Some useful data -----------------------------------------------------------]

  var emptyGif = 'data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==';

  var _externalData = externalData('zukit_jsdata'),
      _externalData$colors = _externalData.colors,
      zukitColors = _externalData$colors === void 0 ? {} : _externalData$colors; // Returns one of predefined in SASS files colors


  function getColor(key) {
    return _.get(zukitColors, key, '#cc1818');
  } // Brand assets ---------------------------------------------------------------]

  var brandAssets = {
    namespace: 'zu',
    slug: 'zu-blocks',
    color: getColor('violet'),
    icon: null,
    title: __('Zu Blocks', 'zukit')
  };
  brandAssets.icon = /*#__PURE__*/React.createElement(SVG, {
    width: "24",
    height: "24",
    viewBox: "0 0 24 24",
    xmlns: "http://www.w3.org/2000/svg"
  }, /*#__PURE__*/React.createElement(G, null, /*#__PURE__*/React.createElement(Path, {
    d: "M15.22,6.873 C15.22,6.873 14.383,8.096 13.914,12.049 C13.445,16.006 17.266,15.5 17.266,15.5 Q19.264,15.312 19.264,13.224 C19.264,13.224 19.172,6.516 19.264,6.873 C20.766,9.109 23.242,6.873 23.242,6.873 L23.242,13.993 Q23.242,16.279 21.737,17.422 Q20.231,18.565 17.242,18.565 Q14.42,18.27 12.914,17.127 C12.914,17.127 11.336,16.393 10.367,13.908 C9.107,10.676 11.242,6.873 11.242,6.873 z",
    fill: brandAssets.color
  }), /*#__PURE__*/React.createElement(Path, {
    d: "M7.448,14.858 C8.266,16.469 11.164,15.236 11.164,15.236 L17.242,18.565 L0.758,18.565 L6.08,10.203 L1.47,10.203 C1.47,10.203 3.141,7.828 1.47,6.873 C0.922,6.844 12.742,6.873 12.742,6.873 C12.742,6.873 6.256,12.508 7.448,14.858 z",
    fill: brandAssets.color
  }))); // Register ZU blocks category (or any other if 'categoryData' is presented)

  function registerCategory() {
    var categoryData = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;
    var category = _.isEmpty(categoryData) ? {
      slug: brandAssets.slug,
      title: brandAssets.title,
      icon: brandAssets.icon
    } : categoryData;
    setCategories([category].concat(_toConsumableArray(getCategories().filter(function (_ref2) {
      var slug = _ref2.slug;
      return slug !== category.slug;
    }))));
  }
  function registerCollection() {
    var collectionData = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;
    var collection = _.isEmpty(collectionData) ? {
      namespace: brandAssets.namespace,
      title: brandAssets.title,
      icon: brandAssets.icon
    } : collectionData;

    if (typeof registerBlockCollection === 'function') {
      registerBlockCollection(collection.namespace, collection);
      return true;
    }

    return false;
  } // Subset of functions for 'zukit-blocks'

  var blocksSet = {
    registerCategory: registerCategory,
    registerCollection: registerCollection,
    externalData: externalData,
    mergeClasses: mergeClasses,
    hexToRGB: hexToRGB,
    hexToRGBA: hexToRGBA,
    isNum: isNum,
    toBool: toBool,
    toRange: toRange,
    getKey: getKey,
    getIds: getIds,
    getColor: getColor,
    toJSON: toJSON,
    svgRef: svgRef,
    emptyGif: emptyGif,
    brandAssets: brandAssets
  };

  // WordPress dependencies
  var _$1 = lodash;
  var _wp = wp,
      apiFetch = _wp.apiFetch; // Internal dependencies
  var cacheKey = 'cache';
  var routerKey = 'router';
  var apiBaseURL = '/zukit/v1/'; // restRouter serves to identify the plugin that currently uses the REST API,
  // since all plugins inherit the same Zukit_plugin class and identification
  // is required to determine which of the active plugins should respond to ajax requests.
  // Therefore, we automatically add the 'router' param to all API request.

  var restRouter = null; // Ajax actions and options update --------------------------------------------]
  // Если status === 'data' просто возвращаем данные из property 'data',
  // в противном случае формируем и отображаем 'Notice'

  function onSuccessAjax(createNotice, request) {
    var callback = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;
    var loading = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : null;

    var actionKey = _$1.get(request, 'options.key'); // const actionData = [{ className: 'zukit-data', label: actionKey }];


    return function (ajaxData) {
      var _ref = ajaxData || {},
          _ref$status = _ref.status,
          status = _ref$status === void 0 ? 'warning' : _ref$status,
          content = _ref.content,
          _ref$data = _ref.data,
          data = _ref$data === void 0 ? null : _ref$data,
          withData = _ref.withData,
          _ref$withHTML = _ref.withHTML,
          withHTML = _ref$withHTML === void 0 ? true : _ref$withHTML,
          message = _ref.message,
          params = _ref.params; // mark action as 'complete'


      if (_$1.isFunction(loading)) loading(_defineProperty({}, actionKey, false)); // Если 'notice' combined with 'data' - transform to 'real' status

      if (_$1.includes(status, 'data')) {
        status = status.replace('data', '');
        withData = true;
      } // if 'data' - pass it to callback


      if (status === 'data' || withData) {
        if (_$1.isFunction(callback)) callback(data);
      } // if 'soft' error message


      if (status === false && message) {
        status = 'error';
        content = message;
      }

      if (_$1.isNil(content)) {
        content = 'Unknown action';
        params = {
          action: actionKey
        };
      }

      if (status !== 'data' && !withData) {
        createNotice({
          status: status,
          // Can be one of: success, info, warning, error
          content: messageWithError(content, params),
          // Text string to display
          isDismissible: true,
          // Whether the user can dismiss the notice
          // actions: params,							// Any actions the user can perform
          __unstableHTML: withHTML
        });
      }
    };
  }

  function onErrorAjax(createNotice, request, loading) {
    var requestKey = _$1.get(request, 'options.key') || _$1.get(request, 'options.keys');

    return function (error) {
      // mark action as 'complete'
      if (_$1.isFunction(loading)) loading(_defineProperty({}, requestKey, false));

      var _parseError = parseError(error, {
        action: requestKey
      }),
          _parseError2 = _slicedToArray(_parseError, 2),
          message = _parseError2[0],
          param = _parseError2[1]; // const { message = 'Unknown error:' } = error;


      createNotice({
        status: 'error',
        // Can be one of: success, info, warning, error
        content: messageWithError(message, param),
        // Text string to display
        isDismissible: true,
        // Whether the user can dismiss the notice
        // actions: param ? [{ className: 'zukit-data', label: param }] : null,
        __unstableHTML: true
      });
    };
  } // We are trying to find a hook based on options changes (considering cases when
  // key can contain path)


  function getHook(hooks, update) {
    var key = _$1.first(_$1.keys(update));

    var hook = _$1.get(hooks, key);

    if (_$1.isNil(hook)) {
      // here we check different cases when key is path (dot separated)
      if (update[key] !== null) {
        // when the whole object is updated and the hook is set to a nested property
        _$1.forEach(hooks || {}, function (h, k) {
          if (_$1.get(update, k, null) !== null) {
            hook = h;
            key = k;
            return false;
          }
        });
      } else {
        // when an object is deleted and the hook is set to a nested property
        _$1.forEach(hooks || {}, function (h, k) {
          if (_$1.startsWith(k, key)) {
            hook = h;
            key = k;
            return false;
          }
        });
      }
    }

    return [key, hook];
  }

  function hookOptionsUpdate(updateValues, hooks) {
    var _getHook = getHook(hooks, updateValues),
        _getHook2 = _slicedToArray(_getHook, 2),
        updateKey = _getHook2[0],
        updateHook = _getHook2[1];

    if (!_$1.isFunction(updateHook)) return _$1.noop;
    return function () {
      return updateHook(updateKey, updateValues[updateKey]);
    };
  }

  function hookOptionsReset(options, hooks) {
    var _ref2 = options || {},
        _ref2$prev = _ref2.prev,
        prev = _ref2$prev === void 0 ? {} : _ref2$prev,
        _ref2$next = _ref2.next,
        next = _ref2$next === void 0 ? {} : _ref2$next;

    _$1.forEach(hooks || {}, function (hook, key) {
      // call hook only if value is changed
      if (_$1.isFunction(hook) && prev[key] !== next[key]) hook(key, next[key]);
    });
  }

  function ajaxDoAction(params, callback, createNotice, updateLoading) {
    var _ref3 = _$1.isPlainObject(params) ? params : {
      action: params
    },
        action = _ref3.action,
        _ref3$value = _ref3.value,
        value = _ref3$value === void 0 ? null : _ref3$value;

    var requestData = {
      route: 'action',
      options: {
        key: action,
        value: value
      }
    }; // mark action as 'loading'

    updateLoading(_defineProperty({}, action, true));
    postAndCatchWithOptions(_objectSpread2(_objectSpread2({}, requestData), {}, {
      onSuccess: onSuccessAjax(createNotice, requestData, callback, updateLoading),
      onError: onErrorAjax(createNotice, requestData, updateLoading)
    }));
  }
  function ajaxUpdateOptions(keys, values, createNotice, updateHooks) {
    // если 'keys' is null - значит это options reset и просто проверяем все hooks
    if (keys === null) {
      hookOptionsReset(values, updateHooks);
      return;
    } // если 'keys' простая строка и 'values' не содержит такого ключа - преобразовать
    // 'values' в нужную форму


    if (_$1.isString(keys) && !_$1.has(values, keys)) values = _defineProperty({}, keys, values);
    var requestData = {
      route: 'options',
      options: {
        // router: restRouter,
        keys: keys,
        values: values
      }
    };
    postAndCatchWithOptions(_objectSpread2(_objectSpread2({}, requestData), {}, {
      onSuccess: hookOptionsUpdate(values, updateHooks),
      onError: onErrorAjax(createNotice)
    }));
  } // Some helpers for API fetch -------------------------------------------------]
  // Если сообщение об ошибке заканчивается ": <value>", то отделяем <value> от строки
  // сообщения и превращаем его в отдельный param

  function parseError(error, requestKey) {
    var _error$message = error.message,
        errMessage = _error$message === void 0 ? 'Unknown error:' : _error$message;
    var message = errMessage,
        param = requestKey;
    var match = /:\s*(.+)$/.exec(errMessage);

    if (match !== null) {
      message = errMessage.replace(match[1], '');
      param = _$1.isNil(param) ? match[1] : "".concat(match[1], " [").concat(param, "]");
    }

    return [message, param];
  }

  function serializeData(data) {
    var cache = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;
    var skip = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : [];

    // remove all elements with "empty" value (undefined, null)
    var obj = _$1.omitBy(data, _$1.isNil); // check for cacheKey in object and then remove it (skip) from serialization


    if (_$1.has(obj, cacheKey)) {
      cache = obj[cacheKey];
      skip.push(cacheKey);
    }

    var str = [];

    for (var p in obj) {
      if (_$1.has(obj, p) && !_$1.includes(skip, p)) {
        // process array as JSON if presented in value
        var value = _$1.isArray(obj[p]) ? toJSON(obj[p]) : obj[p];
        str.push("".concat(encodeURIComponent(p), "=").concat(encodeURIComponent(value)));
      }
    } // Automatically add the "router" param to all API request


    if (!_$1.has(obj, routerKey)) str.push("".concat(routerKey, "=").concat(encodeURIComponent(restRouter)));

    if (cache) {
      var random = Math.floor(Math.random() * 1000000);
      str.push("q=".concat(random));
    }

    return str.join('&');
  } // Check URL and transform it if needed


  function requestURL(url, options) {
    var router = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;
    var picked = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : [];
    var customBaseURL = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : null;
    var baseURL = customBaseURL || apiBaseURL; // extend url with API base
    // and remove any leading and trailing slashes

    var requestUrl = !_$1.startsWith(url, baseURL) ? baseURL + url.replace(/^\\+|\\+$/g, '') : url.replace(/\\+$/g, ''); // add 'router' if is defined

    var optionsWithRouter = _$1.isNil(router) ? options : _$1.set(_objectSpread2({}, options), routerKey, router); // maybe pick only some keys

    var urlOptions = !_$1.isEmpty(picked) ? _$1.pick(optionsWithRouter, picked) : optionsWithRouter; // convert data to query string for requests without BODY

    if (!_$1.isEmpty(urlOptions)) requestUrl = "".concat(requestUrl, "/?").concat(serializeData(urlOptions, urlOptions.cache));
    return requestUrl;
  }

  function requestURLWithRoot(root, version, url, options) {
    var router = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : null;
    var picked = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : [];
    var apiBase = "/".concat(root, "/v").concat(version, "/");
    return requestURL(url, options, router, picked, apiBase);
  } // create GET API Promise with Route and Options, then execute it and process results with callbacks


  function fetchAndCatchWithOptions(_ref4) {
    var route = _ref4.route,
        options = _ref4.options,
        picked = _ref4.picked,
        onSuccess = _ref4.onSuccess,
        onError = _ref4.onError;
    apiFetch({
      path: requestURL(route, options, picked)
    }).then(function (data) {
      if (_$1.isFunction(onSuccess)) onSuccess(data);
    }).catch(function (error) {
      if (_$1.isFunction(onError)) onError(error);
    });
  } // create POST API Promise with Route and Options, then execute it and process results with callbacks

  function postAndCatchWithOptions(_ref5) {
    var route = _ref5.route,
        options = _ref5.options,
        picked = _ref5.picked,
        onSuccess = _ref5.onSuccess,
        onError = _ref5.onError,
        router = _ref5.router;
    var method = 'POST';
    var postRouter = router || restRouter;

    var requestOptions = _objectSpread2(_objectSpread2({}, options), {}, {
      router: postRouter
    });

    apiFetch({
      path: requestURL(route),
      method: method,
      data: !_$1.isEmpty(picked) ? _$1.pick(requestOptions, picked) : requestOptions
    }).then(function (data) {
      if (_$1.isFunction(onSuccess)) onSuccess(data);
    }).catch(function (error) {
      if (_$1.isFunction(onError)) onError(error);
    });
  } // Subset of functions for 'zukit-blocks'

  var blocksSet$1 = {
    serializeData: serializeData,
    requestURL: requestURLWithRoot,
    fetchAndCatchWithOptions: fetchAndCatchWithOptions,
    postAndCatchWithOptions: postAndCatchWithOptions
  };

  // WordPress dependencies
  var _lodash = lodash,
      forEach = _lodash.forEach,
      set = _lodash.set,
      unset = _lodash.unset,
      isPlainObject = _lodash.isPlainObject,
      isFunction = _lodash.isFunction,
      keys = _lodash.keys,
      castArray = _lodash.castArray,
      reduce = _lodash.reduce;
  var _wp$element = wp.element,
      useCallback = _wp$element.useCallback,
      useReducer = _wp$element.useReducer,
      useRef = _wp$element.useRef; // Internal dependencies

  function optionsReducer(options, action) {
    switch (action.type) {
      case 'set':
        // payload -> update object { key: value, key2: value2 }
        // use the 'set' instead of a simple assignment, because 'key' can be 'path'
        // if 'value' is 'null' then we remove the property at 'path' of object
        forEach(action.payload, function (val, key) {
          return val === null ? unset(options, key) : set(options, key, val);
        }); // we can't just return 'options' with changes, we must return a new object

        return _objectSpread2({}, options);

      case 'pre-reset':
        // payload -> callback function
        if (isFunction(action.payload)) action.payload(options);
        return options;

      case 'reset':
        // payload -> new options object
        return action.payload;

      default:
        return options;
    }
  } // Update 'options' atributte
  // Create callback to pass down a 'dispatch' function from 'useReducer' via context


  function useOptions(initialOptions, createNotice) {
    var _useReducer = useReducer(optionsReducer, initialOptions),
        _useReducer2 = _slicedToArray(_useReducer, 2),
        options = _useReducer2[0],
        dispatch = _useReducer2[1];

    var hooks = useRef(null);
    var updateOptions = useCallback(function (update) {
      var reset = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;
      if (!isPlainObject(update)) return;

      if (reset) {
        // forced to use the callback trick to get the current 'options'
        dispatch({
          type: 'pre-reset',
          payload: function payload(prevOptions) {
            ajaxUpdateOptions(null, {
              prev: prevOptions,
              next: update
            }, null, hooks.current);
            dispatch({
              type: 'reset',
              payload: update
            });
          }
        });
      } else {
        ajaxUpdateOptions(keys(update), update, createNotice, hooks.current);
        dispatch({
          type: 'set',
          payload: update
        });
      }
    }, [createNotice]);
    var setUpdateHook = useCallback(function (key, callback) {
      var keys = castArray(key); // create object for all keys {key: callback}

      var callbacks = reduce(keys, function (acc, val) {
        return acc[val] = callback, acc;
      }, {});
      hooks.current = _objectSpread2(_objectSpread2({}, hooks.current || {}), callbacks);
    }, []);
    return [options, updateOptions, setUpdateHook];
  }

  // WordPress dependencies
  var _lodash$1 = lodash,
      forEach$1 = _lodash$1.forEach,
      get = _lodash$1.get,
      set$1 = _lodash$1.set,
      isPlainObject$1 = _lodash$1.isPlainObject,
      isFunction$1 = _lodash$1.isFunction,
      mapValues = _lodash$1.mapValues;
  var _wp$element$1 = wp.element,
      createContext = _wp$element$1.createContext,
      useContext = _wp$element$1.useContext,
      useCallback$1 = _wp$element$1.useCallback,
      useReducer$1 = _wp$element$1.useReducer; // Internal dependencies
  // Context and reducer to be used for passing 'getPanel' callback down to component tree
  // The identity of the 'dispatch' function from 'useReducer' is always stable!

  var PanelsContext = createContext();
  PanelsContext.displayName = 'ZukitPanelsContext';

  function panelsReducer(panels, action) {
    switch (action.type) {
      case 'set':
        // payload -> update object { key: value, key2: value2 }
        // callback -> callback function(panels)
        // используем функцию 'set' чтобы поменять только 'value', а не весь объект
        forEach$1(action.payload, function (value, key) {
          return set$1(panels, "".concat(key, ".value"), value);
        });
        if (isFunction$1(action.callback)) action.callback(panels); // we can't just return 'panels' with changes, we must return a new object

        return _objectSpread2({}, panels);

      default:
        return panels;
    }
  } // Update 'panels' atributte
  // Create callback to pass down a 'dispatch' function from 'useReducer' via context


  function usePanels(initialPanels, createNotice) {
    var _useReducer = useReducer$1(panelsReducer, initialPanels),
        _useReducer2 = _slicedToArray(_useReducer, 2),
        panels = _useReducer2[0],
        dispatch = _useReducer2[1];

    var setPanel = useCallback$1(function (update) {
      if (!isPlainObject$1(update)) return; // forced to use the callback trick to get the current 'panels'
      // we want 'updatePanels' to be independent of changes in 'panels'

      dispatch({
        type: 'set',
        payload: update,
        callback: function callback(panels) {
          return (// не используем функцию 'updateOptions' чтобы не вызывать не нужное обновление 'options'
            // что приведет к излишним renders - нам нужно только сохранить 'panels' в базе
            ajaxUpdateOptions('panels', mapValues(panels, function (p) {
              return p.value;
            }), createNotice)
          );
        }
      });
    }, [createNotice]);
    var getPanel = useCallback$1(function (action) {
      if (action === undefined) action = {
        type: 'all'
      };

      switch (action.type) {
        case 'all':
          return panels;

        case 'hidden':
          return action.id !== undefined && !get(panels, "".concat(action.id, ".value"));

        case 'value':
          return get(panels, "".concat(action.id, ".value"));

        case 'title':
          return get(panels, "".concat(action.id, ".label"));

        case 'falsely':
          return !checkDependency(get(panels, action.id), action.options);

        default:
          return panels;
      }
    }, [panels]);
    return [getPanel, setPanel, PanelsContext];
  }

  // WordPress dependencies
  var _wp$element$2 = wp.element,
      useContext$1 = _wp$element$2.useContext,
      createContext$1 = _wp$element$2.createContext;
  var createHigherOrderComponent = wp.compose.createHigherOrderComponent; // Context to make Notices be accessible by many components in the tree,
  // and at different nesting levels

  var NoticesContext = createContext$1();
  NoticesContext.displayName = 'ZukitNoticesContext';
  var withNoticesContext = createHigherOrderComponent(function (WrappedComponent) {
    return function (props) {
      return /*#__PURE__*/React.createElement(NoticesContext.Consumer, null, function (context) {
        return /*#__PURE__*/React.createElement(WrappedComponent, _extends({
          noticeOperations: context
        }, props));
      });
    };
  }, 'withZukitNoticesContext');

  // WordPress dependencies
  var _lodash$2 = lodash,
      get$1 = _lodash$2.get,
      map = _lodash$2.map,
      isEmpty = _lodash$2.isEmpty,
      isNil = _lodash$2.isNil,
      omitBy = _lodash$2.omitBy,
      pickBy = _lodash$2.pickBy;
  var __$1 = wp.i18n.__;
  var _wp$element$3 = wp.element,
      Fragment = _wp$element$3.Fragment,
      useCallback$2 = _wp$element$3.useCallback;
  var _wp$components$1 = wp.components,
      PanelBody = _wp$components$1.PanelBody,
      PanelRow = _wp$components$1.PanelRow,
      Button = _wp$components$1.Button,
      ExternalLink = _wp$components$1.ExternalLink,
      ToggleControl = _wp$components$1.ToggleControl,
      Spinner = _wp$components$1.Spinner; // Internal dependencies

  function availablePanels(panels, options) {
    return pickBy(panels, function (p) {
      return checkDependency(p, options);
    });
  }

  var ZukitSidebar = function ZukitSidebar(_ref) {
    var version = _ref.version,
        title = _ref.title,
        author = _ref.author,
        link = _ref.link,
        description = _ref.description,
        _ref$icon = _ref.icon,
        icon = _ref$icon === void 0 ? null : _ref$icon,
        more = _ref.more,
        actions = _ref.actions,
        actionLoading = _ref.actionLoading,
        debug = _ref.debug,
        ajaxAction = _ref.ajaxAction,
        options = _ref.options,
        updateOptions = _ref.updateOptions,
        getPanel = _ref.getPanel,
        setPanel = _ref.setPanel;
    var panels = availablePanels(getPanel(), options);
    var moreItems = omitBy(more, isNil);
    var pluginActions = pickBy(omitBy(actions, isNil), function (_ref2) {
      var depends = _ref2.depends;
      return checkDependency(depends, options, true);
    });
    var hasMoreItems = !isEmpty(moreItems);
    var hasActions = !isEmpty(pluginActions);
    var hasPanels = !isEmpty(panels);
    var debugSet = get$1(debug, 'prefix', null);
    var debugOptions = debugSet ? get$1(debug, 'options') : null;
    var debugActions = debugSet ? omitBy(get$1(debug, 'actions'), isNil) : null;
    var hasDebug = (!isEmpty(debugActions) || !isEmpty(debugOptions)) && get$1(panels, "".concat(debugSet, ".value")) === true;

    var debugValue = function debugValue(k) {
      return get$1(options, debugSet ? "".concat(debugSet, ".").concat(k) : k);
    };

    var toggleDebugOptions = useCallback$2(function (key) {
      updateOptions(_defineProperty({}, "".concat(debugSet, ".").concat(key), !get$1(options, "".concat(debugSet, ".").concat(key))));
    }, [debugSet, options, updateOptions]);
    var resetOptions = useCallback$2(function () {
      ajaxAction('reset_options', function (options) {
        return updateOptions(options, true);
      });
    }, [ajaxAction, updateOptions]);
    return /*#__PURE__*/React.createElement("div", {
      className: "block-editor-block-inspector"
    }, /*#__PURE__*/React.createElement("div", {
      className: "block-editor-block-card"
    }, icon, /*#__PURE__*/React.createElement("div", {
      className: "block-editor-block-card__content"
    }, /*#__PURE__*/React.createElement("h2", {
      className: "block-editor-block-card__title"
    }, title), /*#__PURE__*/React.createElement("span", {
      className: "block-editor-block-card__description"
    }, description))), /*#__PURE__*/React.createElement(PanelBody, {
      title: __$1('Plugin Info', 'zukit'),
      initialOpen: false
    }, /*#__PURE__*/React.createElement(PanelRow, null, /*#__PURE__*/React.createElement("span", null, __$1('Version', 'zukit')), /*#__PURE__*/React.createElement("span", null, version)), /*#__PURE__*/React.createElement(PanelRow, null, /*#__PURE__*/React.createElement("span", null, __$1('Author', 'zukit')), /*#__PURE__*/React.createElement(ExternalLink, {
      href: link
    }, author)), hasMoreItems && map(moreItems, function (_ref3, moreKey) {
      var label = _ref3.label,
          value = _ref3.value,
          link = _ref3.link;
      return /*#__PURE__*/React.createElement(PanelRow, {
        key: moreKey
      }, /*#__PURE__*/React.createElement("span", null, label), link ? /*#__PURE__*/React.createElement(ExternalLink, {
        href: link
      }, value) : /*#__PURE__*/React.createElement("span", null, value));
    }), /*#__PURE__*/React.createElement(PanelRow, null, /*#__PURE__*/React.createElement(Button, {
      className: "__plugin_actions admin-blue",
      icon: 'admin-settings',
      isSecondary: true,
      onClick: resetOptions
    }, __$1('Reset Plugin Options', 'zukit')))), hasActions && /*#__PURE__*/React.createElement(PanelBody, {
      title: __$1('Actions', 'zukit'),
      initialOpen: true
    }, map(pluginActions, function (_ref4, actionKey) {
      var _mergeClasses;

      var label = _ref4.label,
          value = _ref4.value,
          icon = _ref4.icon,
          color = _ref4.color,
          help = _ref4.help,
          depends = _ref4.depends;
      return checkDependency(depends, options, true) && /*#__PURE__*/React.createElement(Fragment, {
        key: actionKey
      }, /*#__PURE__*/React.createElement(PanelRow, null, /*#__PURE__*/React.createElement(Button, {
        className: mergeClasses('__plugin_actions', (_mergeClasses = {}, _defineProperty(_mergeClasses, color, color), _defineProperty(_mergeClasses, 'is-loading', get$1(actionLoading, value)), _mergeClasses)),
        icon: icon,
        isSecondary: true,
        onClick: function onClick() {
          return ajaxAction(value);
        }
      }, label, get$1(actionLoading, value) && /*#__PURE__*/React.createElement(Spinner, null))), help && /*#__PURE__*/React.createElement("p", {
        className: mergeClasses('__help', _defineProperty({}, color, color))
      }, help));
    })), hasPanels && /*#__PURE__*/React.createElement(PanelBody, {
      title: __$1('Screen Options', 'zukit'),
      initialOpen: false
    }, map(panels, function (_ref5, panelKey) {
      var label = _ref5.label,
          value = _ref5.value,
          help = _ref5.help;
      return /*#__PURE__*/React.createElement(ToggleControl, {
        key: panelKey,
        label: label,
        help: help,
        checked: value,
        onChange: function onChange() {
          return setPanel(_defineProperty({}, panelKey, !value));
        }
      });
    })), hasDebug && /*#__PURE__*/React.createElement(PanelBody, {
      title: getPanel({
        type: 'title',
        id: debugSet
      }),
      initialOpen: false
    }, map(debugOptions, function (_ref6, key) {
      var label = _ref6.label,
          help = _ref6.help;
      return /*#__PURE__*/React.createElement(ToggleControl, {
        key: key,
        label: label,
        help: help,
        checked: !!debugValue(key),
        onChange: function onChange() {
          return toggleDebugOptions(key);
        }
      });
    }), map(debugActions, function (_ref7, actionKey) {
      var _mergeClasses3;

      var label = _ref7.label,
          value = _ref7.value,
          icon = _ref7.icon,
          color = _ref7.color;
      return /*#__PURE__*/React.createElement(PanelRow, {
        key: actionKey
      }, /*#__PURE__*/React.createElement(Button, {
        className: mergeClasses('__plugin_actions', (_mergeClasses3 = {}, _defineProperty(_mergeClasses3, color, color), _defineProperty(_mergeClasses3, 'is-loading', get$1(actionLoading, value)), _mergeClasses3)),
        icon: icon,
        isSecondary: true,
        onClick: function onClick() {
          return ajaxAction(value);
        }
      }, label, get$1(actionLoading, value) && /*#__PURE__*/React.createElement(Spinner, null)));
    })));
  };

  // WordPress dependencies
  var _lodash$3 = lodash,
      keys$1 = _lodash$3.keys,
      has = _lodash$3.has,
      get$2 = _lodash$3.get,
      includes = _lodash$3.includes,
      isEmpty$1 = _lodash$3.isEmpty,
      forEach$2 = _lodash$3.forEach,
      omit = _lodash$3.omit,
      reduce$1 = _lodash$3.reduce,
      first = _lodash$3.first,
      castArray$1 = _lodash$3.castArray;
  var __$2 = wp.i18n.__;
  var compose = wp.compose.compose;
  var RawHTML = wp.element.RawHTML;
  var BlockIcon = wp.blockEditor.BlockIcon;
  var withNotices = wp.components.withNotices;
  var _wp$element$4 = wp.element,
      useState = _wp$element$4.useState,
      useCallback$3 = _wp$element$4.useCallback,
      useEffect = _wp$element$4.useEffect; // Internal dependencies

  var cprefix = 'zukit-skeleton';

  function editorClasses(element) {
    var more = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';
    var layout = 'edit-post-layout is-mode-visual is-sidebar-opened';
    var prefix50 = 'block-editor-editor-skeleton';
    var prefix55 = 'interface-interface-skeleton';
    var prefixZu = 'zukit-skeleton';
    var classes = "".concat(prefix50, "__").concat(element, " ").concat(prefix55, "__").concat(element, " ").concat(prefixZu, "__").concat(element);
    if (isEmpty$1(element)) classes = "".concat(prefix50, " ").concat(prefix55, " ").concat(prefixZu, " ").concat(layout);else if (element === 'editor') classes = "".concat(prefixZu, "__").concat(element);
    return "".concat(classes, " ").concat(more).trim();
  } // const editorClasses = {
  // 	skeleton: 'block-editor-editor-skeleton',
  // 	body: 'block-editor-editor-skeleton__body',
  // 	content: 'block-editor-editor-skeleton__content',
  // 	sidebar: 'block-editor-editor-skeleton__sidebar',
  // };
  //
  // const editorClasses55 = {
  // 	skeleton: 'interface-interface-skeleton',
  // 	body: 'interface-interface-skeleton__body',
  // 	content: 'interface-interface-skeleton__content',
  // 	sidebar: 'interface-interface-skeleton__sidebar',
  // };


  var ZukitSkeleton = function ZukitSkeleton(_ref) {
    var id = _ref.id,
        EditComponent = _ref.edit,
        _ref$options = _ref.options,
        initialOptions = _ref$options === void 0 ? {} : _ref$options,
        _ref$panels = _ref.panels,
        initialPanels = _ref$panels === void 0 ? {} : _ref$panels,
        _ref$info = _ref.info,
        info = _ref$info === void 0 ? {} : _ref$info,
        actions = _ref.actions,
        debug = _ref.debug,
        noticeUI = _ref.noticeUI,
        _ref$noticeOperations = _ref.noticeOperations,
        noticeOperations = _ref$noticeOperations === void 0 ? {} : _ref$noticeOperations;
    var createNotice = noticeOperations.createNotice;

    var _useState = useState(info.more || {}),
        _useState2 = _slicedToArray(_useState, 2),
        moreInfo = _useState2[0],
        setMoreInfo = _useState2[1];

    var _useState3 = useState( // create object {action_value: state} from 'actions'
    reduce$1(actions, function (acc, val) {
      return acc[val.value] = false, acc;
    }, // from 'debug.actions'
    reduce$1(debug.actions, function (acc, val) {
      return acc[val.value] = false, acc;
    }, {}))),
        _useState4 = _slicedToArray(_useState3, 2),
        loading = _useState4[0],
        setLoading = _useState4[1];

    var updateLoading = useCallback$3(function (update) {
      var updateKey = first(keys$1(update)); // update only if we have this 'key' in 'loading'

      if (has(loading, updateKey)) {
        setLoading(function (prevLoading) {
          return _objectSpread2(_objectSpread2({}, prevLoading || {}), update || {});
        });
      }
    }, [loading]); // create 'options' and setter

    var _useOptions = useOptions(initialOptions, createNotice),
        _useOptions2 = _slicedToArray(_useOptions, 3),
        options = _useOptions2[0],
        updateOptions = _useOptions2[1],
        setUpdateHook = _useOptions2[2]; // create getter and setter for 'panels'


    var _usePanels = usePanels(initialPanels, createNotice),
        _usePanels2 = _slicedToArray(_usePanels, 3),
        getPanel = _usePanels2[0],
        setPanel = _usePanels2[1],
        PanelsContext = _usePanels2[2];

    var ajaxAction = useCallback$3(function (params, callback) {
      ajaxDoAction(params, callback, createNotice, updateLoading);
    }, [createNotice, updateLoading]); // set hooks to update info.more items when dependency keys (in 'depends') are updated in 'options'

    useEffect(function () {
      var infoKeys = reduce$1(moreInfo, function (acc, value) {
        forEach$2(castArray$1(get$2(value, 'depends', [])), function (val) {
          return includes(acc, val) ? null : acc.push(val);
        });
        return acc;
      }, []);
      setUpdateHook(infoKeys, function () {
        ajaxAction('zukit_more_info', function (infoData) {
          setMoreInfo(get$2(infoData, 'more', {}));
        });
      });
    }, [moreInfo, setUpdateHook, ajaxAction]);
    var pluginOptionsEdit = !EditComponent ? null : /*#__PURE__*/React.createElement(NoticesContext.Provider, {
      value: noticeOperations
    }, /*#__PURE__*/React.createElement(PanelsContext.Provider, {
      value: getPanel
    }, /*#__PURE__*/React.createElement(EditComponent, {
      id: id,
      info: info,
      title: "".concat(info.title, " ").concat(__$2('Settings', 'zukit')),
      options: options,
      updateOptions: updateOptions,
      ajaxAction: ajaxAction,
      noticeOperations: noticeOperations,
      setUpdateHook: setUpdateHook
    })));
    var pluginIcon = !info.icon ? null : /*#__PURE__*/React.createElement(BlockIcon, {
      icon: /*#__PURE__*/React.createElement(RawHTML, null, info.icon),
      showColors: true
    }); // custom appearance

    var backdropColor = get$2(info, 'colors.backdrop');
    var headerColor = get$2(info, 'colors.header');
    var titleColor = get$2(info, 'colors.title');
    return /*#__PURE__*/React.createElement("div", {
      className: editorClasses(null, cprefix)
    }, /*#__PURE__*/React.createElement("div", {
      className: editorClasses('body')
    }, /*#__PURE__*/React.createElement("div", {
      className: editorClasses('content'),
      role: "region",
      "aria-label": "Settings content",
      tabIndex: "-1",
      style: backdropColor && {
        backgroundColor: backdropColor
      }
    }, /*#__PURE__*/React.createElement("div", {
      className: "components-editor-notices__dismissible"
    }, noticeUI), /*#__PURE__*/React.createElement("div", {
      className: editorClasses('editor', 'editor-styles-wrapper'),
      tabIndex: "-1"
    }, /*#__PURE__*/React.createElement("div", {
      className: "block-editor-block-list__layout"
    }, /*#__PURE__*/React.createElement("div", {
      className: "wp-block block-editor-block-list__block"
    }, /*#__PURE__*/React.createElement("div", {
      className: "editor-post-title",
      style: headerColor && {
        backgroundColor: headerColor
      }
    }, /*#__PURE__*/React.createElement("div", {
      className: "wp-block editor-post-title__block"
    }, /*#__PURE__*/React.createElement("h1", {
      style: titleColor && {
        color: titleColor
      }
    }, info.title), pluginIcon)), pluginOptionsEdit)))), /*#__PURE__*/React.createElement("div", {
      className: editorClasses('sidebar'),
      role: "region",
      "aria-label": "Plugin settings",
      tabIndex: "-1"
    }, /*#__PURE__*/React.createElement("div", null, /*#__PURE__*/React.createElement("div", {
      className: "interface-complementary-area edit-post-sidebar"
    }, /*#__PURE__*/React.createElement(ZukitSidebar, _extends({
      id: id,
      icon: pluginIcon,
      more: moreInfo,
      actions: actions,
      actionLoading: loading,
      debug: debug,
      ajaxAction: ajaxAction,
      options: options,
      updateOptions: updateOptions,
      getPanel: getPanel,
      setPanel: setPanel
    }, omit(info, ['icon', 'more']))))))));
  };

  compose([withNotices])(ZukitSkeleton);

  // WordPress dependencies
  var _lodash$4 = lodash,
      includes$1 = _lodash$4.includes; // Internal dependencies

  var defaultUnit = 'em';

  var ZukitDivider = function ZukitDivider(_ref) {
    var className = _ref.className,
        size = _ref.size,
        _ref$unit = _ref.unit,
        unit = _ref$unit === void 0 ? defaultUnit : _ref$unit;
    var sizeUnit = includes$1(unit, ['px', 'em', 'rem', '%']) ? unit : defaultUnit;
    var sizeValue = toRange(size, 0, 100);
    var style = sizeValue > 0 ? {
      marginBottom: "".concat(sizeValue).concat(sizeUnit),
      paddingTop: "".concat(sizeValue).concat(sizeUnit)
    } : null;
    return /*#__PURE__*/React.createElement("div", {
      className: mergeClasses('zukit-divider', className),
      style: style
    });
  };

  // WordPress dependencies
  var _lodash$5 = lodash,
      get$3 = _lodash$5.get,
      set$2 = _lodash$5.set,
      map$1 = _lodash$5.map,
      has$1 = _lodash$5.has,
      forEach$3 = _lodash$5.forEach,
      defaultsDeep = _lodash$5.defaultsDeep;
  var __$3 = wp.i18n.__;
  var _wp$element$5 = wp.element,
      render = _wp$element$5.render,
      Fragment$1 = _wp$element$5.Fragment;
  var _wp$components$2 = wp.components,
      ToggleControl$1 = _wp$components$2.ToggleControl,
      SelectControl = _wp$components$2.SelectControl,
      Button$1 = _wp$components$2.Button; // Internal dependencies

  function checkDivider(item) {
    return has$1(item, 'divider') ? true : null;
  }

  function toggleOption(toggleOptions, options, updateOptions) {
    var withPath = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : null;

    var optionValue = function optionValue(k) {
      return get$3(options, withPath ? "".concat(withPath, ".").concat(k) : k);
    };

    return map$1(toggleOptions, function (item, key) {
      return checkDependency(item, options) && /*#__PURE__*/React.createElement(Fragment$1, {
        key: key
      }, /*#__PURE__*/React.createElement(ToggleControl$1, {
        label: item.label,
        help: item.help,
        checked: !!optionValue(key),
        onChange: function onChange() {
          return updateOptions(_defineProperty({}, key, !optionValue(key)));
        }
      }), checkDivider(item) && /*#__PURE__*/React.createElement(ZukitDivider, {
        size: item.divider
      }));
    });
  }
  function selectOption(value, option, updateOptions) {
    var id = option.id,
        _option$options = option.options,
        options = _option$options === void 0 ? [] : _option$options,
        _option$label = option.label,
        label = _option$label === void 0 ? '' : _option$label,
        help = option.help,
        defaultValue = option.defaultValue;
    return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement("label", {
      className: "components-base-control__label __select_label",
      htmlFor: id
    }, label), /*#__PURE__*/React.createElement("div", {
      className: "__select_block"
    }, /*#__PURE__*/React.createElement("div", {
      className: "__select_control"
    }, /*#__PURE__*/React.createElement(SelectControl, {
      id: id,
      value: value,
      onChange: function onChange(value) {
        return updateOptions(_defineProperty({}, id, value));
      },
      options: options
    }), /*#__PURE__*/React.createElement(Button$1, {
      isSecondary: true,
      className: "__reset",
      onClick: function onClick() {
        return updateOptions(_defineProperty({}, id, defaultValue));
      }
    }, __$3('Reset', 'zukit'))), /*#__PURE__*/React.createElement("p", {
      className: "components-base-control__help"
    }, help)));
  }

  var blocksSet$2 = {
    toggleOption: toggleOption,
    selectOption: selectOption
  };

  // WordPress dependencies
  var _lodash$6 = lodash,
      isArray = _lodash$6.isArray,
      isPlainObject$2 = _lodash$6.isPlainObject,
      isNil$1 = _lodash$6.isNil,
      forEach$4 = _lodash$6.forEach;
  var $ = jQuery; //-----------------------------------------------------------------------------]
  // Remove element classes with wildcard matching. Optionally add classes:
  //     $( '#foo' ).alterClass( 'foo-* bar-*', 'foobar' )
  //
  //  Copyright (c) 2011 Pete Boere (https://gist.github.com/peteboere/1517285)
  //

  $.fn.alterClass = function (removals, additions) {
    var self = this;

    if (!removals || removals.indexOf('*') === -1) {
      // Use native jQuery methods if there is no wildcard matching
      self.removeClass(removals);
      return !additions ? self : self.addClass(additions);
    }

    var patt = new RegExp('\\s' + removals.replace(/\*/g, '[A-Za-z0-9-_]+').split(' ').join('\\s|\\s') + '\\s', 'g');
    self.each(function (_i, it) {
      var cn = ' ' + it.className + ' ';

      while (patt.test(cn)) {
        cn = cn.replace(patt, ' ');
      }

      it.className = $.trim(cn);
    });
    return !additions ? self : self.addClass(additions);
  };

  function toggleBodyClass(className, state) {
    $('body').toggleClass(className, state);
  }
  function alterClassWithClientId(clientId, selector, removals, additions) {
    $("#block-".concat(clientId, " ").concat(selector)).alterClass(removals, additions);
  } // if we just have a pair of 'name' and 'value' and if 'value' === undefined then remove the attribute,
  // otherwise, set it to the given 'value'
  // if 'name' is an array - remove all attributes with names from the array
  // if 'name' is an object - do 'forEach' for each property and process it
  // as a simple pair of 'name' and 'value'

  function attrWithClientId(clientId, name, value) {
    var selector = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : '';
    var $el = $("#block-".concat(clientId, " ").concat(selector));

    if ($el.length) {
      var processAttr = function processAttr(val, key) {
        return val === undefined ? $el.removeAttr(key) : $el.attr(key, val);
      };

      if (isArray(name)) {
        forEach$4(name, function (val) {
          return $el.removeAttr(val);
        });
      } else if (isPlainObject$2(name)) {
        forEach$4(name, processAttr);
      } else {
        processAttr(value, name);
      }
    }
  } // similar to the previous description

  function cssWithClientId(clientId, name, value) {
    var selector = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : '';
    var $el = $("#block-".concat(clientId, " ").concat(selector));

    if ($el.length) {
      var processCss = function processCss(val, key) {
        return val === undefined ? $el.css(key, '') : $el.css(key, val);
      };

      if (isArray(name)) {
        forEach$4(name, function (val) {
          return $el.css(val, '');
        });
      } else if (isPlainObject$2(name)) {
        forEach$4(name, processCss);
      } else {
        processCss(value, name);
      }
    }
  }
  function setInputAndFocus(parent) {
    var value = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';
    var selector = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 'input';
    $(parent).find(selector).val(value).focus();
  }
  function clickButton(parent) {
    var selector = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'button';
    $(parent).find(selector).click();
  }
  function setAttr(parent, selector, attributes) {
    $(parent).find(selector).attr(attributes);
  }
  function hasSelector(parent, selector) {
    return $(parent).has(selector).length > 0;
  } // Creates a function to observe the DOM mutation and attaches callback to it

  function createMutationObserver(callback) {
    var MutationObserver = window.MutationObserver || window.WebKitMutationObserver;
    var observer = new MutationObserver(callback);
    return observer;
  } // Finds an element by 'selector' and start observing it for the events of mutation.
  // By default observed only 'childList' and its 'subtree'. If en element was not found
  // then 'disconnect' observer.

  function observeMutation(selector, observer) {
    var $node = $(selector);

    if ($node.length === 0 || isNil$1(observer)) {
      observer && observer.disconnect();
      return;
    }

    observer.observe($node[0], {
      childList: true,
      subtree: true,
      attributes: false,
      characterData: false
    });
  }

  var jq = /*#__PURE__*/Object.freeze({
    __proto__: null,
    toggleBodyClass: toggleBodyClass,
    alterClassWithClientId: alterClassWithClientId,
    attrWithClientId: attrWithClientId,
    cssWithClientId: cssWithClientId,
    setInputAndFocus: setInputAndFocus,
    clickButton: clickButton,
    setAttr: setAttr,
    hasSelector: hasSelector,
    createMutationObserver: createMutationObserver,
    observeMutation: observeMutation
  });

  // Conditional Wrap Component
  // condition ? wrap(children) : children
  var ConditionalWrap = function ConditionalWrap(_ref) {
    var className = _ref.className,
        condition = _ref.condition,
        elseDiv = _ref.elseDiv,
        wrappingDiv = _ref.wrappingDiv,
        wrappingLink = _ref.wrappingLink,
        wrap = _ref.wrap,
        children = _ref.children,
        additionalProps = _objectWithoutProperties(_ref, ["className", "condition", "elseDiv", "wrappingDiv", "wrappingLink", "wrap", "children"]);

    // maybe Wrapping Component is <div>
    var wrappingComponent = !wrappingDiv ? null : /*#__PURE__*/React.createElement("div", _extends({
      className: className
    }, additionalProps), children); // maybe Wrapping Component is <a>

    if (wrappingLink) wrappingComponent = /*#__PURE__*/React.createElement("a", _extends({
      className: className
    }, additionalProps), children); // if wrappingComponent is still undefined then use "wrap" as component

    if (!wrappingComponent) {
      var Wrap = wrap;
      wrappingComponent = /*#__PURE__*/React.createElement(Wrap, _extends({
        className: className
      }, additionalProps), children);
    }

    return condition ? wrappingComponent : elseDiv ? /*#__PURE__*/React.createElement("div", {
      className: className
    }, children) : children;
  };

  // WordPress dependencies
  var _lodash$7 = lodash,
      map$2 = _lodash$7.map,
      defaults = _lodash$7.defaults,
      upperFirst = _lodash$7.upperFirst,
      isFunction$2 = _lodash$7.isFunction,
      isPlainObject$3 = _lodash$7.isPlainObject,
      every = _lodash$7.every,
      pick = _lodash$7.pick;
  var _wp$components$3 = wp.components,
      BaseControl = _wp$components$3.BaseControl,
      Tooltip = _wp$components$3.Tooltip,
      Button$2 = _wp$components$3.Button,
      ButtonGroup = _wp$components$3.ButtonGroup; // Internal dependencies

  var cname = 'zukit-select-item';
  var buttonPossibleProps = ['href', 'target', 'disabled', 'icon', 'iconSize', 'shortcut', 'onMouseDown', 'isPrimary', 'isTertiary', 'isPressed', 'isBusy', 'isDefault', 'isLink', 'isDestructive'];

  var SelectItemControl = function SelectItemControl(_ref) {
    var className = _ref.className,
        _ref$columns = _ref.columns,
        columns = _ref$columns === void 0 ? 2 : _ref$columns,
        _ref$isSecondary = _ref.isSecondary,
        isSecondary = _ref$isSecondary === void 0 ? true : _ref$isSecondary,
        _ref$isSmall = _ref.isSmall,
        isSmall = _ref$isSmall === void 0 ? true : _ref$isSmall,
        withoutControl = _ref.withoutControl,
        recap = _ref.recap,
        options = _ref.options,
        selectedItem = _ref.selectedItem,
        transformValue = _ref.transformValue,
        beforeItem = _ref.beforeItem,
        afterItem = _ref.afterItem,
        label = _ref.label,
        help = _ref.help,
        buttonStyle = _ref.buttonStyle,
        buttonClass = _ref.buttonClass,
        withLabels = _ref.withLabels,
        withTooltip = _ref.withTooltip,
        _onClick = _ref.onClick,
        additionalProps = _objectWithoutProperties(_ref, ["className", "columns", "isSecondary", "isSmall", "withoutControl", "recap", "options", "selectedItem", "transformValue", "beforeItem", "afterItem", "label", "help", "buttonStyle", "buttonClass", "withLabels", "withTooltip", "onClick"]);

    var makeItem = function makeItem(_ref2) {
      var label = _ref2.label,
          value = _ref2.value,
          style = _ref2.style,
          isDisabled = _ref2.isDisabled;
      return /*#__PURE__*/React.createElement(ConditionalWrap, {
        condition: withTooltip,
        wrap: Tooltip,
        text: label,
        key: getKey(value, label)
      }, /*#__PURE__*/React.createElement("div", {
        key: getKey(value, label),
        className: mergeClasses("".concat(cname, "__button-wrapper"), "".concat(cname, "__").concat(value), {
          'is-selected': selectedItem === value && !isDisabled,
          'is-disabled': isDisabled
        })
      }, /*#__PURE__*/React.createElement(Button$2, _extends({
        className: mergeClasses("".concat(cname, "__button"), buttonClass, "".concat(cname, "__").concat(value), _defineProperty({}, 'is-selected', selectedItem === value && !isDisabled)),
        isSecondary: isSecondary,
        isSmall: isSmall,
        onClick: function onClick() {
          return isDisabled ? false : _onClick(value);
        },
        style: style || buttonStyle
      }, pick(additionalProps, buttonPossibleProps)), isFunction$2(transformValue) ? transformValue(value, label, style) : value), withLabels && /*#__PURE__*/React.createElement("div", {
        className: "block-editor-block-styles__item-label"
      }, label)));
    };

    var defaultRecapOptions = {
      label: upperFirst(selectedItem),
      value: selectedItem,
      style: null,
      isDisabled: true
    };
    var recapOptions = isPlainObject$3(recap) ? defaults(recap, defaultRecapOptions) : defaultRecapOptions;
    var selectOptions = every(options, function (o) {
      return isPlainObject$3(o);
    }) ? options : map$2(options, function (o) {
      return {
        label: upperFirst(o),
        value: o
      };
    });
    return /*#__PURE__*/React.createElement(ConditionalWrap, {
      condition: !withoutControl,
      elseDiv: true,
      wrap: BaseControl,
      className: mergeClasses(cname, "__".concat(columns, "columns"), 'components-base-control', {
        '__recap': recap
      }, className),
      label: label,
      help: help
    }, /*#__PURE__*/React.createElement(ButtonGroup, {
      "aria-label": label
    }, beforeItem, recap && makeItem(recapOptions), map$2(selectOptions, makeItem), afterItem));
  };

  // WordPress dependencies
  var _lodash$8 = lodash,
      isArray$1 = _lodash$8.isArray,
      isEmpty$2 = _lodash$8.isEmpty,
      isNil$2 = _lodash$8.isNil,
      map$3 = _lodash$8.map,
      pull = _lodash$8.pull,
      split = _lodash$8.split,
      join = _lodash$8.join,
      includes$2 = _lodash$8.includes,
      has$2 = _lodash$8.has;
  var __$4 = wp.i18n.__;
  var ENTER = wp.keycodes.ENTER;
  var compose$1 = wp.compose.compose;
  var _wp$components$4 = wp.components,
      BaseControl$1 = _wp$components$4.BaseControl,
      Button$3 = _wp$components$4.Button,
      TextControl = _wp$components$4.TextControl,
      Tooltip$1 = _wp$components$4.Tooltip;
  var _wp$element$6 = wp.element,
      useState$1 = _wp$element$6.useState,
      useCallback$4 = _wp$element$6.useCallback,
      useMemo = _wp$element$6.useMemo;
  var _wp$url = wp.url,
      isEmail = _wp$url.isEmail,
      isURL = _wp$url.isURL; // Internal dependencies

  var cprefix$1 = 'zukit-list-input';
  var closeIcon = 'no-alt';

  var isKind = function isKind(kind, value) {
    // https://stackoverflow.com/questions/4338267/validate-phone-number-with-javascript
    var phoneRegex = /^[+]?[(]?[0-9]{3}[)]?[-\s.]?[0-9]{3}[-\s.]?[0-9]{4,6}$/g;
    if (isNil$2(kind)) return true;
    if (kind === 'email') return isEmail(value);
    if (kind === 'url') return isURL(value);
    if (kind === 'tel' || kind === 'phone') return phoneRegex.test(value); // otherwise any string that we use as a Regular Expression

    var re = new RegExp(kind);
    return re.test(value);
  };

  var messages = {
    duplicate: __$4('Duplicates are not allowed', 'zukit'),
    email: __$4('It does not look like a valid email.', 'zukit'),
    url: __$4('It does not look like a URL.', 'zukit'),
    tel: __$4('It does not look like a phone number.', 'zukit'),
    regex: __$4('It does not look like a valid input.', 'zukit')
  };

  var messageByKind = function messageByKind(kind, value) {
    if (kind === 'phone') kind = 'tel';
    var msg = has$2(messages, kind) ? messages[kind] : messages.regex;
    return messageWithError(msg, value);
  };

  var ListInputControl = function ListInputControl(_ref) {
    var _ref$separator = _ref.separator,
        separator = _ref$separator === void 0 ? ',' : _ref$separator,
        label = _ref.label,
        help = _ref.help,
        inputLabel = _ref.inputLabel,
        strict = _ref.strict,
        value = _ref.value,
        onChange = _ref.onChange,
        noticeOperations = _ref.noticeOperations;
    var createNotice = noticeOperations.createNotice;

    var _useState = useState$1(''),
        _useState2 = _slicedToArray(_useState, 2),
        currentItem = _useState2[0],
        setCurrentItem = _useState2[1];

    var _useState3 = useState$1(false),
        _useState4 = _slicedToArray(_useState3, 2),
        editMode = _useState4[0],
        setEditMode = _useState4[1]; // convert string value to array if needed


    var items = useMemo(function () {
      return isArray$1(value) ? value : isEmpty$2(value) ? [] : split(value, separator);
    }, [value, separator]); // remove an item by its value

    var onRemoveItem = useCallback$4(function (value) {
      var wasCount = items.length;
      pull(items, value);

      if (items.length < wasCount) {
        onChange(join(items, separator));
      }
    }, [items, onChange, separator]); // clean the list

    var onReset = useCallback$4(function () {
      onChange('');
    }, [onChange]); // add an item to the list (only unique values are allowed)

    var onAddItem = useCallback$4(function () {
      if (!includes$2(items, currentItem)) {
        if (isKind(strict, currentItem)) {
          items.push(currentItem);
          onChange(join(items, separator));
          setCurrentItem('');
        } else {
          // Can be one of: success, info, warning, error
          createNotice({
            status: 'error',
            content: messageByKind(strict, currentItem),
            isDismissible: true,
            __unstableHTML: true
          });
        }
      } else {
        createNotice({
          status: 'warning',
          content: messageWithError(messages.duplicate, currentItem),
          isDismissible: true,
          __unstableHTML: true
        });
      }
    }, [currentItem, items, onChange, separator, strict, createNotice]); // add an item on ENTER key pressed

    var onKeyDown = useCallback$4(function (event) {
      var keyCode = event.keyCode;

      if (keyCode === ENTER) {
        onAddItem();
      }
    }, [onAddItem]);
    var isDesc = label || help;
    return /*#__PURE__*/React.createElement(BaseControl$1, {
      className: cprefix$1
    }, isDesc && /*#__PURE__*/React.createElement("div", {
      className: "__desc"
    }, label && /*#__PURE__*/React.createElement("label", {
      className: "components-base-control__label"
    }, label), help && /*#__PURE__*/React.createElement("p", {
      className: "components-base-control__help"
    }, help)), /*#__PURE__*/React.createElement("div", {
      className: "__list"
    }, map$3(items, function (val) {
      return /*#__PURE__*/React.createElement("div", {
        className: "__list-item",
        key: getKey(val)
      }, /*#__PURE__*/React.createElement("span", null, val), /*#__PURE__*/React.createElement(Tooltip$1, {
        text: __$4('Remove', 'zukit'),
        position: "top center"
      }, /*#__PURE__*/React.createElement(Button$3, {
        className: "__remove",
        isSecondary: true,
        icon: closeIcon,
        onClick: function onClick() {
          return onRemoveItem(val);
        }
      })));
    }), !editMode && /*#__PURE__*/React.createElement(Button$3, {
      className: "__edit __plugin_actions __auto admin-blue",
      icon: "admin-settings",
      isSecondary: true,
      onClick: function onClick() {
        return setEditMode(true);
      }
    }, __$4('Modify', 'zukit'))), editMode && /*#__PURE__*/React.createElement("div", {
      className: "components-animate__appear is-from-top __input"
    }, /*#__PURE__*/React.createElement(TextControl, {
      label: inputLabel || __$4('Enter new item', 'zukit'),
      value: currentItem,
      onChange: setCurrentItem,
      onKeyDown: onKeyDown
    }), /*#__PURE__*/React.createElement(Button$3, {
      className: "__add __plugin_actions admin-blue",
      icon: "tag",
      isSecondary: true,
      onClick: onAddItem
    }, __$4('Add', 'zukit')), /*#__PURE__*/React.createElement(Button$3, {
      className: "__reset __plugin_actions magenta",
      isSecondary: true,
      icon: "trash",
      onClick: onReset
    }, __$4('Reset All', 'zukit'))));
  };

  var listInputControl = compose$1([withNoticesContext])(ListInputControl);

  // WordPress dependencies
  var _lodash$9 = lodash,
      isNil$3 = _lodash$9.isNil;
  var __$5 = wp.i18n.__;
  var _wp$components$5 = wp.components,
      Button$4 = _wp$components$5.Button,
      TextControl$1 = _wp$components$5.TextControl,
      Tooltip$2 = _wp$components$5.Tooltip;
  var _wp$element$7 = wp.element,
      useCallback$5 = _wp$element$7.useCallback,
      useState$2 = _wp$element$7.useState; // Internal dependencies

  var labels = {
    show: __$5('Show Password', 'zukit'),
    hide: __$5('Hide Password', 'zukit'),
    clear: __$5('Clear', 'zukit')
  };

  var isKind$1 = function isKind(kind, value) {
    if (value === '' || isNil$3(kind)) return true;
    if (kind === 'number') return /^[0-9]+$/g.test(value);
    if (kind === 'email') return /^[a-zA-Z0-9._@-]+$/g.test(value);
    if (kind === 'url') return /^[.a-zA-Z0-9-]+$/g.test(value);
    if (kind === 'tel' || kind === 'phone') return /^[0-9()+-\s]+$/g.test(value); // otherwise any string that we use as a Regular Expression

    var re = new RegExp(kind);
    return re.test(value);
  };

  var AdvTextControl = function AdvTextControl(_ref) {
    var className = _ref.className,
        isPassword = _ref.isPassword,
        _ref$showTooltip = _ref.showTooltip,
        showTooltip = _ref$showTooltip === void 0 ? true : _ref$showTooltip,
        withoutClear = _ref.withoutClear,
        label = _ref.label,
        value = _ref.value,
        help = _ref.help,
        type = _ref.type,
        strict = _ref.strict,
        onChange = _ref.onChange;

    var _useState = useState$2(false),
        _useState2 = _slicedToArray(_useState, 2),
        visible = _useState2[0],
        setVisible = _useState2[1];

    var controlType = isPassword ? visible ? 'text' : 'password' : type || 'text';
    var controlIcon = isPassword ? visible ? 'hidden' : 'visibility' : 'no-alt';
    var controlTooltip = isPassword ? visible ? labels.hide : labels.show : labels.clear;
    var onClick = useCallback$5(function () {
      return isPassword ? setVisible(!visible) : onChange('');
    }, [isPassword, visible, onChange]);
    var onValidatedChange = useCallback$5(function (val) {
      if (isKind$1(strict, val)) onChange(val);
    }, [strict, onChange]);
    return /*#__PURE__*/React.createElement("div", {
      className: mergeClasses('components-base-control', 'zukit-text-control', className)
    }, /*#__PURE__*/React.createElement(TextControl$1, {
      type: controlType,
      label: label,
      help: help,
      value: value || '',
      onChange: onValidatedChange
    }), (isPassword || !withoutClear) && /*#__PURE__*/React.createElement(ConditionalWrap, {
      wrap: Tooltip$2,
      condition: showTooltip,
      text: controlTooltip,
      position: "top center"
    }, /*#__PURE__*/React.createElement(Button$4, {
      className: "__exclude",
      icon: controlIcon,
      onClick: onClick
    })));
  };

  // WordPress dependencies
  // https://developer.wordpress.org/block-editor/packages/packages-data/
  var _lodash$a = lodash,
      keys$2 = _lodash$a.keys,
      get$4 = _lodash$a.get;
  var registerStore = wp.data.registerStore;
  var _wp$1 = wp,
      apiFetch$1 = _wp$1.apiFetch; // Internal dependencies
  var GET_VALUE = 'GET_VALUE';
  var SET_VALUE = 'SET_VALUE';
  var UPDATE_VALUES = 'UPDATE_VALUES'; // An empty object indicates that no value was found for option,
  // or something went wrong during the option update

  var isNull = function isNull(val) {
    return Object.keys(val).length === 0 && val.constructor === Object;
  };

  function getReadOnlyActions() {
    return {
      getValue: function getValue(path) {
        return {
          type: GET_VALUE,
          path: path
        };
      },
      setValue: function setValue(key, value) {
        var params = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};
        return _objectSpread2({
          type: SET_VALUE,
          key: key,
          value: value
        }, params);
      }
    };
  }

  function getActions(route, router) {
    var readOnly = getReadOnlyActions();
    return _objectSpread2(_objectSpread2({}, readOnly), {}, {
      updateValues: /*#__PURE__*/regeneratorRuntime.mark(function updateValues(values) {
        var path, data, result;
        return regeneratorRuntime.wrap(function updateValues$(_context) {
          while (1) {
            switch (_context.prev = _context.next) {
              case 0:
                path = requestURL(route);
                data = {
                  router: router,
                  keys: keys$2(values),
                  values: values
                };
                _context.next = 4;
                return apiFetch$1({
                  path: path,
                  method: 'POST',
                  data: data
                });

              case 4:
                result = _context.sent;
                return _context.abrupt("return", isNull(result) ? undefined : {
                  type: UPDATE_VALUES,
                  values: values
                });

              case 6:
              case "end":
                return _context.stop();
            }
          }
        }, updateValues);
      })
    });
  }
  function defaultGetter(state, stateKey, key) {
    return get$4(state, [stateKey, key]);
  }
  function getSelectors(stateKey) {
    var stateGetter = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;
    var getter = stateGetter || defaultGetter;
    return {
      getValue: function getValue(state, key) {
        var params = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};
        return getter(state, stateKey, key, params);
      }
    };
  }
  function getControls() {
    return {
      GET_VALUE: function GET_VALUE(action) {
        return apiFetch$1({
          path: action.path
        });
      }
    };
  }
  function getResolvers(route, router, actions) {
    return {
      getValue: /*#__PURE__*/regeneratorRuntime.mark(function getValue(key) {
        var params,
            path,
            value,
            _args2 = arguments;
        return regeneratorRuntime.wrap(function getValue$(_context2) {
          while (1) {
            switch (_context2.prev = _context2.next) {
              case 0:
                params = _args2.length > 1 && _args2[1] !== undefined ? _args2[1] : {};
                path = requestURL(route, _objectSpread2({
                  key: key
                }, params), router);
                _context2.next = 4;
                return actions.getValue(path);

              case 4:
                value = _context2.sent;
                return _context2.abrupt("return", actions.setValue(key, isNull(value) ? undefined : value, params));

              case 6:
              case "end":
                return _context2.stop();
            }
          }
        }, getValue);
      })
    };
  }
  function defaultSetValueMerger(prevState, stateKey, action) {
    return _objectSpread2(_objectSpread2({}, prevState), {}, _defineProperty({}, stateKey, _objectSpread2(_objectSpread2({}, prevState[stateKey]), {}, _defineProperty({}, action.key, action.value))));
  }

  function getReducer(stateKey, initialState) {
    var setValueMerger = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;
    var merger = setValueMerger || defaultSetValueMerger;
    return function () {
      var state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : initialState;
      var action = arguments.length > 1 ? arguments[1] : undefined;

      switch (action.type) {
        case SET_VALUE:
          return merger(state, stateKey, action);

        case UPDATE_VALUES:
          return _objectSpread2(_objectSpread2({}, state), {}, _defineProperty({}, stateKey, _objectSpread2(_objectSpread2({}, state[stateKey]), action.values)));
      }

      return state;
    };
  }

  function setupStore(store, key, routes, router) {
    var withSetters = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : true;
    var defaultState = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : null;
    var setValueMerger = arguments.length > 6 && arguments[6] !== undefined ? arguments[6] : null;
    var stateGetter = arguments.length > 7 && arguments[7] !== undefined ? arguments[7] : null;

    var initialState = defaultState || _defineProperty({}, key, {});

    var getRoute = get$4(routes, 'get', routes);
    var updateRoute = get$4(routes, 'update', routes);
    var actions = withSetters ? getActions(updateRoute, router) : getReadOnlyActions();
    return {
      register: function register() {
        return registerStore(store, {
          reducer: getReducer(key, initialState, setValueMerger),
          actions: actions,
          selectors: getSelectors(key, stateGetter),
          controls: getControls(),
          resolvers: getResolvers(getRoute, router, actions)
        });
      }
    };
  }

  // WordPress dependencies
  var _lodash$b = lodash,
      isEmpty$3 = _lodash$b.isEmpty,
      isNil$4 = _lodash$b.isNil,
      get$5 = _lodash$b.get,
      includes$3 = _lodash$b.includes,
      repeat = _lodash$b.repeat,
      forEach$5 = _lodash$b.forEach;
  var createHigherOrderComponent$1 = wp.compose.createHigherOrderComponent;
  var _wp$data = wp.data,
      withSelect = _wp$data.withSelect,
      useSelect = _wp$data.useSelect; // Internal dependencies

  var ZUKIT_STORE = 'zukit/core';
  var FolderDepthSymbol = "\xA0";
  var FolderDepthShift = 4;
  var basicKeys = ['loaders', 'galleries', 'folders']; // Custom Core Data state merger & getter

  function mergeData(prevState, stateKey, action) {
    var key = action.key,
        value = action.value;
    var prevDataState = get$5(prevState, stateKey, {});
    var prevKeyState = get$5(prevDataState, key, {});

    if (includes$3(basicKeys, key)) {
      return defaultSetValueMerger(prevState, stateKey, action);
    } else if (key === 'svg') {
      var name = action.name,
          folder = action.folder;
      var prevFolderState = get$5(prevKeyState, folder, {});
      return _objectSpread2(_objectSpread2({}, prevState), {}, _defineProperty({}, stateKey, _objectSpread2(_objectSpread2({}, prevDataState), {}, {
        svg: _objectSpread2(_objectSpread2({}, prevKeyState), {}, _defineProperty({}, folder, _objectSpread2(_objectSpread2({}, prevFolderState), {}, _defineProperty({}, name, value))))
      })));
    }

    return prevState;
  }

  function dataGetter(state, stateKey, key, params) {
    if (includes$3(basicKeys, key)) {
      return defaultGetter(state, stateKey, key);
    } else if (key === 'svg') {
      var name = params.name,
          folder = params.folder;
      return get$5(state, [stateKey, key, folder, name]);
    }

    return undefined;
  }

  var _setupStore = setupStore(ZUKIT_STORE, 'data', 'zudata', null, false, {
    data: {
      folders: {},
      loaders: {},
      galleries: {},
      svg: {}
    }
  }, mergeData, dataGetter),
      registerCoreStore = _setupStore.register;

  registerCoreStore(); // const emptyArray = [];
  // const emptyObject = {};
  // Custom hooks ---------------------------------------------------------------]
  // Custom hook which returns Generic Core Data

  var useCoreDataGeneric = function useCoreDataGeneric(key, params) {
    var _useSelect = useSelect(function (select) {
      return {
        data: select(ZUKIT_STORE).getValue(key, params)
      };
    }, [key, params]),
        _useSelect$data = _useSelect.data,
        data = _useSelect$data === void 0 ? null : _useSelect$data;

    return isEmpty$3(data) ? null : data;
  }; // Custom hook which returns SVG from file in folder

  var useSvgFromFileGeneric = function useSvgFromFileGeneric(name) {
    var folder = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'images/';
    var router = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;

    var _useSelect2 = useSelect(function (select) {
      if (isEmpty$3(name)) return {};
      return {
        svg: select(ZUKIT_STORE).getValue('svg', {
          router: router,
          name: name,
          folder: folder
        })
      };
    }, [name, folder]),
        _useSelect2$svg = _useSelect2.svg,
        svg = _useSelect2$svg === void 0 ? null : _useSelect2$svg;

    return isEmpty$3(svg) ? null : svg;
  }; // Get Folders/Galleries ------------------------------------------------------]
  // Higher-order component which add 'folders' to the original component

  var withFolders = createHigherOrderComponent$1(withSelect(function (select) {
    return {
      folders: select(ZUKIT_STORE).getValue('folders') || null
    };
  }), 'withFolders');
  var folderOptions = function folderOptions(folders) {
    function folderOps(folder, ops, depth, parentId) {
      if (folder.parent_id !== parentId) return;
      ops.push({
        label: repeat(FolderDepthSymbol, depth * FolderDepthShift) + folder.title,
        value: folder.id
      });
      forEach$5(folder.childs, function (id) {
        folderOps(folders[id], ops, ++depth, folder.id);
        --depth;
      });
    }

    var folderDepth = 0;
    var options = [];
    forEach$5(folders, function (f) {
      if (f.parent_id === 0) folderOps(f, options, folderDepth, 0);
    });
    return options;
  }; // Custom hook which returns 'folders' (all folders if folderId is 'null')

  var useFolders = function useFolders() {
    var folderId = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;
    var asOptions = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;

    var _useSelect3 = useSelect(function (select) {
      return {
        folders: select(ZUKIT_STORE).getValue('folders')
      };
    }, []),
        _useSelect3$folders = _useSelect3.folders,
        folders = _useSelect3$folders === void 0 ? null : _useSelect3$folders;

    return isEmpty$3(folders) ? null : folderId === null ? asOptions ? folderOptions(folders) : folders : get$5(folders, folderId, null);
  }; // Custom hook which returns 'galleries' (all galleries if postId is 'null')

  var useGalleries = function useGalleries() {
    var postId = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;

    var _useSelect4 = useSelect(function (select) {
      return {
        galleries: select(ZUKIT_STORE).getValue('galleries')
      };
    }, []),
        _useSelect4$galleries = _useSelect4.galleries,
        galleries = _useSelect4$galleries === void 0 ? null : _useSelect4$galleries;

    return isEmpty$3(galleries) ? null : postId === null ? galleries : get$5(galleries, postId, null);
  }; // Get Loaders ----------------------------------------------------------------]
  // Higher-order component which add 'loaderHTML' to the original component

  var withLoaders = createHigherOrderComponent$1(withSelect(function (select, _ref) {
    var loader = _ref.loader;
    var loaderIndex = isNum(loader) ? loader : null;
    var loaderRaw = null;

    if (!isNil$4(loaderIndex)) {
      loaderRaw = select(ZUKIT_STORE).getValue('loaders', {
        loaderIndex: loaderIndex
      }) || null;
    }

    return {
      loaderHTML: isEmpty$3(loaderRaw) ? null : loaderRaw
    };
  }), 'withLoaders'); // Custom hook which returns 'loader' by 'index' (all loaders if index is 'null')

  var useLoaders = function useLoaders() {
    var index = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;

    var _useSelect5 = useSelect(function (select) {
      return {
        loaders: select(ZUKIT_STORE).getValue('loaders')
      };
    }, []),
        _useSelect5$loaders = _useSelect5.loaders,
        loaders = _useSelect5$loaders === void 0 ? null : _useSelect5$loaders;

    return isEmpty$3(loaders) ? null : index === null ? loaders : get$5(loaders, index, null);
  };

  // WordPress dependencies
  var _lodash$c = lodash,
      isNil$5 = _lodash$c.isNil,
      isArray$2 = _lodash$c.isArray,
      isEmpty$4 = _lodash$c.isEmpty,
      some = _lodash$c.some,
      reduce$2 = _lodash$c.reduce;
  var _wp$data$1 = wp.data,
      useSelect$1 = _wp$data$1.useSelect,
      useDispatch = _wp$data$1.useDispatch; // Internal dependencies
  var emptyArray = []; // Setup and re-export Zukit Core store ---------------------------------------]

  function setupCoreStore(router) {
    return {
      useSvgFromFile: function useSvgFromFile(name) {
        var folder = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'images/';
        return useSvgFromFileGeneric(name, folder, router);
      },
      useCoreData: function useCoreData(key, params) {
        return useCoreDataGeneric(key, _objectSpread2(_objectSpread2({}, params), {}, {
          router: router
        }));
      }
    };
  } // re-export all named imports

  function setupOptionsStore(router) {
    var ZUKIT_OPTIONS_STORE = "zukit/".concat(router);

    var _setupStore = setupStore(ZUKIT_OPTIONS_STORE, 'options', {
      get: 'option',
      update: 'options'
    }, router),
        registerOptionsStore = _setupStore.register; // Get/Set/Update Options -------------------------------------------------]
    // Custom hook which returns 'option' by 'key'


    var useGetOption = function useGetOption(key) {
      var defaultValue = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;

      var _useSelect = useSelect$1(function (select) {
        return {
          value: select(ZUKIT_OPTIONS_STORE).getValue(key)
        };
      }, []),
          _useSelect$value = _useSelect.value,
          value = _useSelect$value === void 0 ? null : _useSelect$value;

      return isNil$5(value) ? defaultValue : value;
    }; // Custom hook that returns all the 'options' that were passed in the 'keys' array
    // if 'waitAll' is true - hook returns 'null' as long as there is at least one key with a value of 'null'


    var useGetOptions = function useGetOptions(keys) {
      var waitAll = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;
      var optionKeys = isArray$2(keys) ? keys : emptyArray;

      var _useSelect2 = useSelect$1(function (select) {
        var _select = select(ZUKIT_OPTIONS_STORE),
            getValue = _select.getValue;

        var reduced = reduce$2(optionKeys, function (values, key) {
          values[key] = isNil$5(key) ? null : getValue(key);
          return values;
        }, {});
        return {
          gotOptions: reduced
        };
      }, [optionKeys]),
          _useSelect2$gotOption = _useSelect2.gotOptions,
          gotOptions = _useSelect2$gotOption === void 0 ? null : _useSelect2$gotOption;

      if (waitAll && some(gotOptions, isNil$5)) return null; // если пустой объект, то всегда возвращаем null

      return isEmpty$4(gotOptions) ? null : gotOptions;
    }; // Custom hook which set 'option' by 'key'


    var useSetOption = function useSetOption() {
      var _useDispatch = useDispatch(ZUKIT_OPTIONS_STORE),
          updateValues = _useDispatch.updateValues;

      return function (key, value) {
        return updateValues(_defineProperty({}, key, value));
      };
    }; // Custom hook which update 'option' by 'key'


    var useUpdateOptions = function useUpdateOptions() {
      var _useDispatch2 = useDispatch(ZUKIT_OPTIONS_STORE),
          updateValues = _useDispatch2.updateValues;

      return updateValues;
    };

    return {
      registerOptionsStore: registerOptionsStore,
      useGetOption: useGetOption,
      useGetOptions: useGetOptions,
      useSetOption: useSetOption,
      useUpdateOptions: useUpdateOptions
    };
  } // Re-export all named imports for creating Custom Store ----------------------]

  var data = /*#__PURE__*/Object.freeze({
    __proto__: null,
    setupCoreStore: setupCoreStore,
    setupOptionsStore: setupOptionsStore,
    useCoreDataGeneric: useCoreDataGeneric,
    useSvgFromFileGeneric: useSvgFromFileGeneric,
    withFolders: withFolders,
    folderOptions: folderOptions,
    useFolders: useFolders,
    useGalleries: useGalleries,
    withLoaders: withLoaders,
    useLoaders: useLoaders,
    getActions: getActions,
    defaultGetter: defaultGetter,
    getSelectors: getSelectors,
    getControls: getControls,
    getResolvers: getResolvers,
    defaultSetValueMerger: defaultSetValueMerger,
    setupStore: setupStore
  });

  // WordPress dependencies
  var _lodash$d = lodash,
      isNil$6 = _lodash$d.isNil;
  var RawHTML$1 = wp.element.RawHTML; // Internal dependencies

  var Loader = function Loader(_ref) {
    var className = _ref.className,
        loaderHTML = _ref.loaderHTML;
    return isNil$6(loaderHTML) ? null : /*#__PURE__*/React.createElement(RawHTML$1, {
      className: mergeClasses('zu-loader', className)
    }, loaderHTML);
  };

  var WithOptions = function WithOptions(_ref2) {
    var className = _ref2.className,
        _ref2$id = _ref2.id,
        id = _ref2$id === void 0 ? 'none' : _ref2$id,
        duration = _ref2.duration;
    var loaderHTML = useLoaders(id, duration);
    return /*#__PURE__*/React.createElement(Loader, {
      className: className,
      loaderHTML: loaderHTML
    });
  };

  Loader.WithOptions = WithOptions;

  // WordPress dependencies
  var _lodash$e = lodash,
      reduce$3 = _lodash$e.reduce;
  var __$6 = wp.i18n.__;
  var _wp$element$8 = wp.element,
      useState$3 = _wp$element$8.useState,
      useCallback$6 = _wp$element$8.useCallback,
      useEffect$1 = _wp$element$8.useEffect;
  var _wp$components$6 = wp.components,
      BaseControl$2 = _wp$components$6.BaseControl,
      ToggleControl$2 = _wp$components$6.ToggleControl; // Internal dependencies

  var cprefix$2 = 'zukit-loader-control';

  var LoaderControl = function LoaderControl(_ref) {
    var clientId = _ref.clientId,
        className = _ref.className,
        _ref$editClassName = _ref.editClassName,
        editClassName = _ref$editClassName === void 0 ? '__edit-mode' : _ref$editClassName,
        label = _ref.label,
        _ref$shape = _ref.shape,
        shape = _ref$shape === void 0 ? 'none' : _ref$shape,
        loaders = _ref.loaders,
        setAttributes = _ref.setAttributes;

    var _useState = useState$3(false),
        _useState2 = _slicedToArray(_useState, 2),
        revealLoader = _useState2[0],
        setRevealLoader = _useState2[1];

    var onReveal = useCallback$6(function () {
      setRevealLoader(!revealLoader);
    }, [revealLoader]);
    var onChange = useCallback$6(function (loader) {
      if (loaders === null) return;
      setAttributes({
        loader: loader,
        loaderHTML: loaders[loader] || ''
      });
    }, [loaders, setAttributes]); // Clear all DOM modifications on unmount

    useEffect$1(function () {
      return function () {
        alterClassWithClientId(clientId, '> :first-child', editClassName); // cssWithClientId(clientId, 'opacity', undefined, `.${editClassName}`); // '.zu-gallery__edit'

        cssWithClientId(clientId, 'opacity', undefined, '.zu-loader');
      }; // eslint-disable-next-line react-hooks/exhaustive-deps
    }, []);
    useEffect$1(function () {
      alterClassWithClientId(clientId, '> :first-child', revealLoader ? null : editClassName, revealLoader ? editClassName : null); // cssWithClientId(clientId, 'opacity', revealLoader ? 0.2 : undefined, `.${editClassName}`); // '.zu-gallery__edit'

      cssWithClientId(clientId, 'opacity', revealLoader ? 1 : undefined, '.zu-loader');
    }, [clientId, revealLoader, shape, editClassName]);
    if (loaders === null) return null;
    var loaderOptions = reduce$3(loaders, function (options, _val, key) {
      options.push({
        value: String(key),
        label: String(key)
      });
      return options;
    }, [{
      value: 'none',
      label: __$6('Without Loader', 'zukit')
    }]);
    /* translators: loader selection */

    var noLoader = /*#__PURE__*/React.createElement("span", null, __$6('none', 'zukit'));
    return /*#__PURE__*/React.createElement(BaseControl$2, {
      className: mergeClasses(cprefix$2, className),
      label: label
    }, /*#__PURE__*/React.createElement(SelectItemControl, {
      withoutControl: true,
      columns: 3,
      options: loaderOptions,
      selectedItem: shape,
      onClick: onChange,
      transformValue: function transformValue(value) {
        return value === 'none' ? noLoader : /*#__PURE__*/React.createElement(Loader, {
          loaderHTML: loaders[value]
        });
      }
    }), /*#__PURE__*/React.createElement(ToggleControl$2, {
      label: __$6('Reveal Loader', 'zukit'),
      checked: revealLoader,
      onChange: onReveal
    }));
  };

  // Components

  var components = /*#__PURE__*/Object.freeze({
    __proto__: null,
    ConditionalWrap: ConditionalWrap,
    SelectItemControl: SelectItemControl,
    ListInputControl: listInputControl,
    AdvTextControl: AdvTextControl,
    Loader: Loader,
    LoaderControl: LoaderControl
  });

  wp.zukit = {
    fetch: blocksSet$1,
    utils: blocksSet,
    render: blocksSet$2,
    jq: jq,
    components: components,
    data: data
  };

}());
//# sourceMappingURL=zukit-blocks.min.js.map
